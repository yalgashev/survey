{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Edit Surveys for" %} {{ professor.full_name }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2 class="mb-1">{% trans "Edit Surveys" %}</h2>
        <p class="mb-0">{{ professor.full_name }} - {{ professor.school }}</p>
    </div>
    <div class="card-body p-4">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
        
        <p class="mb-3">
            <strong>{% trans "Total Surveys:" %}</strong> {{ surveys.count }}
        </p>
        
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>{% trans "Group" %}</th>
                        <th>{% trans "Date" %}</th>
                        <th>{% trans "Avg Rating" %}</th>
                        <th>{% trans "Actions" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for survey in surveys %}
                        <tr>
                            <td>{{ survey.group.group_name }}</td>
                            <td>{{ survey.created_at|date:"Y-m-d H:i" }}</td>
                            <td>
                                {% with avg=survey.get_average_rating %}
                                    {% if avg > 0 %}
                                        <span class="badge bg-{% if avg <= 2 %}success{% elif avg <= 3.5 %}warning{% else %}danger{% endif %}">
                                            {{ avg|floatformat:2 }}
                                        </span>
                                    {% else %}
                                        N/A
                                    {% endif %}
                                {% endwith %}
                            </td>
                            <td>
                                <a href="{% url 'edit_survey' survey.id %}" 
                                   class="btn btn-sm btn-primary">
                                    {% trans "Edit" %}
                                </a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="4" class="text-center">
                                {% trans "No surveys found for this professor." %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="mt-4">
            <a href="{% url 'edit_professor_list' %}" class="btn btn-secondary">
                {% trans "Back to Professor List" %}
            </a>
        </div>
    </div>
</div>
{% endblock %}
